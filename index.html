<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Pedido | Nilton Manuel</title>
    <style>
        body { font-family: 'Segoe UI', Roboto, sans-serif; background-color: #f0f2f5; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .checkout-card { background: white; width: 100%; max-width: 400px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); padding: 25px; box-sizing: border-box; }
        .header { text-align: center; border-bottom: 2px dashed #eee; padding-bottom: 15px; margin-bottom: 20px; }
        .price-tag { font-size: 28px; color: #1a73e8; font-weight: bold; margin: 10px 0; }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        select, input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; outline: none; }
        select:focus, input:focus { border-color: #1a73e8; }
        .btn-pagar { width: 100%; background: #28a745; color: white; padding: 18px; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; }
        .btn-pagar:active { transform: scale(0.98); }
        .btn-pagar:disabled { background: #94d3a2; cursor: not-allowed; }
        .badges { margin-top: 20px; text-align: center; font-size: 12px; color: #666; line-height: 1.6; }
    </style>
</head>
<body>

<div class="checkout-card">
    <div class="header">
        <h2 style="margin:0">Nilton Manuel</h2>
        <p style="color:#666; margin: 5px 0;">Oportunidade de NegÃ³cio NeoLife</p>
        <div class="price-tag">10,50 MZN</div>
    </div>

    <div class="input-group">
        <label for="metodo">MÃ©todo de Pagamento</label>
        <select id="metodo">
            <option value="mpesa">M-Pesa (Vodacom)</option>
            <option value="emola">e-Mola (Movitel)</option>
            <option value="mkesh">m-Kesh (Tmcel)</option>
        </select>
    </div>

    <div class="input-group">
        <label for="telefone">Seu NÃºmero de Telefone</label>
        <input type="tel" id="telefone" placeholder="Ex: 848841352" maxlength="13">
    </div>

    <button class="btn-pagar" id="main-btn" onclick="processarPagamento()">CONCLUIR PAGAMENTO AGORA</button>

    <div class="badges">
        ðŸ”’ Pagamento 100% Seguro via PaySuite<br>
        âš¡ Receba o pedido de PIN em segundos no seu celular
    </div>
</div>

<script>
async function processarPagamento() {
    const btn = document.getElementById('main-btn');
    const inputTelefone = document.getElementById('telefone');
    const metodoSelecionado = document.getElementById('metodo').value;

    // Limpeza rigorosa do nÃºmero
    let numeroLimpo = inputTelefone.value.replace(/\s+/g, '').replace('+258', '');

    if(!numeroLimpo || numeroLimpo.length < 9) {
        alert("Por favor, insira um nÃºmero vÃ¡lido com 9 dÃ­gitos!");
        return;
    }

    // Estado de carregamento
    btn.innerText = "PROCESSANDO...";
    btn.disabled = true;

    try {
        const response = await fetch('https://paysuite.tech/api/v1/payments', {
            method: 'POST',
            headers: {
                // SUBSTITUA O TOKEN ABAIXO PELO SEU TOKEN REAL DA DASHBOARD
                'Authorization': 'Bearer 1509|Xr2cOqWwevPiSOjfeu26SLrIP7HKFHKxNnUhhfg8c661f603', 
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({
                "amount": 10.50,
                "method": metodoSelecionado,
                "reference": "REF_" + Date.now(), // ReferÃªncia Ãºnica evita erro 422
                "description": "Checkout Alta ConversÃ£o - Nilton",
                "msisdn": numeroLimpo
            })
        });

        const resultado = await response.json();

        if (response.ok) {
            alert("Sucesso! Digite o seu PIN no celular para confirmar o pagamento de 10.50 MT.");
        } else {
            // Exibe a mensagem real de erro da PaySuite (ex: Token InvÃ¡lido ou Saldo Insuficiente)
            alert("Erro da PaySuite: " + (resultado.message || "Verifique os dados e tente novamente."));
        }
    } catch (error) {
        alert("Erro de ConexÃ£o: Verifique sua internet.");
    } finally {
        btn.innerText = "CONCLUIR PAGAMENTO AGORA";
        btn.disabled = false;
    }
}
</script>

</body>
</html>
